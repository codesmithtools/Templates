
'------------------------------------------------------------------------------
' <autogenerated>
'     This code was generated by a CodeSmith Template.
'
'     DO NOT MODIFY contents of this file. Changes to this
'     file will be lost if the code is regenerated.
' </autogenerated>
'------------------------------------------------------------------------------

Imports System
Imports System.Collections.Generic
Imports System.Data.Linq
Imports System.Linq
Imports System.Text

Namespace Tracker.Core.Data
    ''' <summary>
    ''' The manager class for Task.
    ''' </summary>
    Partial Public Class TaskManager 
        Inherits CodeSmith.Data.EntityManagerBase(Of TrackerDataManager, Tracker.Core.Data.Task)

        ''' <summary>
        ''' Initializes the <see cref="TaskManager"/> class.
        ''' </summary>
        ''' <param name="manager">The current manager.</param>
        Public Sub New(ByVal manager As TrackerDataManager) 
            MyBase.New(manager)
            OnCreated()
        End Sub

        ''' <summary>
        ''' Gets the current context.
        ''' </summary>
        Protected ReadOnly Property Context() As Tracker.Core.Data.TrackerDataContext
            Get
                return Manager.Context
            End Get
        End Property
        
        ''' <summary>
        ''' Gets the entity for this manager.
        ''' </summary>
        Protected ReadOnly Property Entity() As System.Data.Linq.Table(Of Tracker.Core.Data.Task)
            Get 
                return Manager.Context.Task
            End Get
        End Property
        
        
        ''' <summary>
        ''' Creates the key for this entity.
        ''' </summary>
        Public Shared Function CreateKey(ByVal id As Integer) As CodeSmith.Data.IEntityKey(Of Integer)
            Return New CodeSmith.Data.EntityKey(Of Integer)(id)
        End Function
        
        ''' <summary>
        ''' Gets an entity by the primary key.
        ''' </summary>
        ''' <param name="key">The key for the entity.</param>
        ''' <returns>
        ''' An instance of the entity or null if not found.
        ''' </returns>
        ''' <remarks>
        ''' This method is expecting key to be of type IEntityKey(Of Integer).
        ''' </remarks>
        ''' <exception cref="ArgumentException">Thrown when key is not of type IEntityKey(Of Integer).</exception>
        Public Overrides Function GetByKey(ByVal key As CodeSmith.Data.IEntityKey) As Tracker.Core.Data.Task
            If (key Is GetType(CodeSmith.Data.IEntityKey(Of Integer))) Then
                Dim entityKey As CodeSmith.Data.IEntityKey(Of Integer) = DirectCast(key, CodeSmith.Data.IEntityKey(Of Integer))
                return GetByKey(entityKey.Key)
            Else
                Throw New ArgumentException("Invalid key, expected key to be of type IEntityKey(Of Integer)")
            End If
        End Function
        
        ''' <summary>
        ''' Gets an instance by the primary key.
        ''' </summary>
        ''' <returns>An instance of the entity or null if not found.</returns>
        Public Overloads Function GetByKey(ByVal id As Integer) As Tracker.Core.Data.Task
            If (Context.LoadOptions Is Nothing) Then 
                return Query.GetByKey.Invoke(Context, id)
            Else
                return Entity.FirstOrDefault(Function(t)t.Id = id)
            End If
        End Function
        
        ''' <summary>
        ''' Immediately deletes the entity by the primary key from the underlying data source with a single delete command.
        ''' </summary>
        ''' <returns>The number of rows deleted from the database.</returns>
        Public Function Delete(ByVal id As Integer) As Integer
            return Entity.Delete(Function(t)t.Id = id)
        End Function
        
        ''' <summary>
        ''' Gets a query by an index.
        ''' </summary>
        Public Overloads Function GetByAssignedIdStatus(ByVal assignedId As Integer?, ByVal status As Status) As IQueryable(Of Tracker.Core.Data.Task)
            If Context.LoadOptions Is Nothing Then 
                return Query.GetByAssignedIdStatus.Invoke(Context, assignedId, status)
            Else
                return Entity.Where(Function(t)Object.Equals(t.AssignedId, assignedId) _
					AndAlso t.Status = status)
            End If
        End Function
        
        ''' <summary>
        ''' Gets a query by an index.
        ''' </summary>
        Public Overloads Function GetByStatus(ByVal status As Status) As IQueryable(Of Tracker.Core.Data.Task)
            If Context.LoadOptions Is Nothing Then 
                return Query.GetByStatus.Invoke(Context, status)
            Else
                return Entity.Where(Function(t)t.Status = status)
            End If
        End Function
        
        ''' <summary>
        ''' Gets a query by an index.
        ''' </summary>
        Public Overloads Function GetByPriority(ByVal priority As Priority) As IQueryable(Of Tracker.Core.Data.Task)
            If Context.LoadOptions Is Nothing Then 
                return Query.GetByPriority.Invoke(Context, priority)
            Else
                return Entity.Where(Function(t)Object.Equals(t.Priority, priority))
            End If
        End Function
        
        ''' <summary>
        ''' Gets a query by an index.
        ''' </summary>
        Public Overloads Function GetByCreatedId(ByVal createdId As Integer) As IQueryable(Of Tracker.Core.Data.Task)
            If Context.LoadOptions Is Nothing Then 
                return Query.GetByCreatedId.Invoke(Context, createdId)
            Else
                return Entity.Where(Function(t)t.CreatedId = createdId)
            End If
        End Function
        
        ''' <summary>
        ''' Gets a query by an index.
        ''' </summary>
        Public Overloads Function GetByAssignedId(ByVal assignedId As Integer?) As IQueryable(Of Tracker.Core.Data.Task)
            If Context.LoadOptions Is Nothing Then 
                return Query.GetByAssignedId.Invoke(Context, assignedId)
            Else
                return Entity.Where(Function(t)Object.Equals(t.AssignedId, assignedId))
            End If
        End Function

        #Region "Extensibility Method Definitions"
        ''' <summary>Called when the class is created.</summary>
        Partial Private Sub OnCreated()
        End Sub
        #End Region
        
        #Region "Query"
        ''' <summary>
        ''' A private class for lazy loading static compiled queries.
        ''' </summary>
        Private Partial Class Query

            Friend Shared Readonly GetByKey As Func(Of Tracker.Core.Data.TrackerDataContext, Integer, Tracker.Core.Data.Task) = _
                CompiledQuery.Compile( _
                     Function(db As Tracker.Core.Data.TrackerDataContext, ByVal id As Integer) _
                        db.Task.FirstOrDefault(Function(t)t.Id = id))

            Friend Shared Readonly  GetByAssignedIdStatus As Func(Of Tracker.Core.Data.TrackerDataContext, Integer?, Status, IQueryable(Of Tracker.Core.Data.Task)) = _
                CompiledQuery.Compile( _
                    Function( db As Tracker.Core.Data.TrackerDataContext , ByVal assignedId As Integer?, ByVal status As Status) _
                        db.Task.Where(Function(t)Object.Equals(t.AssignedId, assignedId) _
							AndAlso t.Status = status))

            Friend Shared Readonly  GetByStatus As Func(Of Tracker.Core.Data.TrackerDataContext, Status, IQueryable(Of Tracker.Core.Data.Task)) = _
                CompiledQuery.Compile( _
                    Function( db As Tracker.Core.Data.TrackerDataContext , ByVal status As Status) _
                        db.Task.Where(Function(t)t.Status = status))

            Friend Shared Readonly  GetByPriority As Func(Of Tracker.Core.Data.TrackerDataContext, Priority, IQueryable(Of Tracker.Core.Data.Task)) = _
                CompiledQuery.Compile( _
                    Function( db As Tracker.Core.Data.TrackerDataContext , ByVal priority As Priority) _
                        db.Task.Where(Function(t)Object.Equals(t.Priority, priority)))

            Friend Shared Readonly  GetByCreatedId As Func(Of Tracker.Core.Data.TrackerDataContext, Integer, IQueryable(Of Tracker.Core.Data.Task)) = _
                CompiledQuery.Compile( _
                    Function( db As Tracker.Core.Data.TrackerDataContext , ByVal createdId As Integer) _
                        db.Task.Where(Function(t)t.CreatedId = createdId))

            Friend Shared Readonly  GetByAssignedId As Func(Of Tracker.Core.Data.TrackerDataContext, Integer?, IQueryable(Of Tracker.Core.Data.Task)) = _
                CompiledQuery.Compile( _
                    Function( db As Tracker.Core.Data.TrackerDataContext , ByVal assignedId As Integer?) _
                        db.Task.Where(Function(t)Object.Equals(t.AssignedId, assignedId)))

        End Class
        #End Region
    End Class
End Namespace

